<!-- index.html (Landing) -->
<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Loopa</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        *{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;user-select:none}
        body{background:#fff;color:#000;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Arial,sans-serif;height:100vh;display:flex;flex-direction:column;justify-content:space-between;align-items:center;padding:60px 30px 40px;text-align:center;overflow:hidden;border-radius:24px}
        .container{max-width:420px;width:100%;height:100%;background:#fff;display:flex;flex-direction:column;justify-content:space-between;align-items:center;box-shadow:0 0 30px rgba(0,0,0,0.1);border-radius:24px;overflow:hidden}
        .title{font-size:2.4em;font-weight:800;margin-bottom:16px}
        .subtitle{font-size:1.15em;color:#555;line-height:1.6;max-width:85%}
        .categories{margin:40px 0 60px;width:100%;display:flex;flex-direction:column;gap:14px;align-items:center}
        .category{background:#e8e8e8;color:#000;padding:14px 28px;border-radius:30px;font-size:1.1em;font-weight:500;width:80%;max-width:320px}
        .btn{background:#011627;color:#fff;border:none;padding:18px 40px;font-size:1.3em;font-weight:600;border-radius:30px;width:80%;max-width:320px;cursor:pointer;box-shadow:0 8px 20px rgba(1,22,39,0.2);transition:transform .2s}
        .btn:active{transform:scale(0.96)}
    </style>
</head>
<body>
    <div class="container">
        <div></div>
        <div>
            <h1 class="title">Loopa'ga<br>Xush Kelibsiz</h1>
            <p class="subtitle">Qulay va zamonaviy onlayn xarid tajribasi. Minglab mahsulotlar bir joyda.</p>
            
            <div class="categories">
                <div class="category">Elektronika</div>
                <div class="category">Uy jihozlari</div>
                <div class="category">O'yinchoqlar</div>
                <div class="category">Sport anjomlari</div>
                <div class="category">Kiyim-kechak</div>
                <div class="category">Kosmetika va go'zallik</div>
            </div>
        </div>
        
        <button class="btn" id="startBtn">Boshlash</button>
    </div>

    <script>
        if(window.Telegram&&Telegram.WebApp){Telegram.WebApp.ready();Telegram.WebApp.expand()}
        document.getElementById('startBtn').addEventListener('click',async()=>{
            const tg=window.Telegram.WebApp;
            const chatId=tg.initDataUnsafe?.user?.id?.toString()||"";
            const username=tg.initDataUnsafe?.user?.username||tg.initDataUnsafe?.user?.first_name||"user";
            if(!chatId){alert("Foydalanuvchi ma'lumotlari topilmadi.");return}
            try{
                const response=await fetch('https://api.loopa.buzz/api/users/login',{
                    method:'POST',
                    headers:{'Content-Type':'application/json'},
                    body:JSON.stringify({chatId:chatId,username:username})
                });
                const result=await response.json();
                if(result.success&&result.data?.token){
                    window.location.href='dashboard.html';
                }else{
                    alert(result.message||"Kirishda xatolik.");
                }
            }catch(error){
                alert("Internet aloqasini tekshiring.");
            }
        });
    </script>
</body>
</html>